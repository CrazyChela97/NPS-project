#TWO-WAYS ANOVA
EventType_seasonality=seasonality:EventType
summary.aov(aov(North_America ~ seasonality + EventType + EventType_seasonality))
seasonality
EventType
seasonality:EventType
#TWO-WAYS ANOVA
EventType_seasonality=as.factor(seasonality):EventType
as.factor(seasonality)
EventType_seasonality
# Without interaction
summary.aov(aov(North_America$TotalItems ~ seasonality + EventType))
T0_EventType_seasonality <- summary.aov(aov(North_America$TotalItems ~ seasonality + EventType + EventType_seasonality))[[1]][3,4]
T0_EventType_seasonality
aov.H0EventType_seasonality <- aov(North_America$TotalItems ~ seasonality + EventType)
aov.H0EventType_seasonality
residuals.H0EventType_seasonality <- aov.H0EventType_seasonality$residuals
n <- length(North_America$TotalItems)
T_EventType_seasonality  <- numeric(B)
for(perm in 1:B){
permutation <- sample(n)
residuals.H0EventType_seasonality <- residuals.H0EventType_seasonality[permutation]
TotalItems.perm.H0EventType_seasonality <- aov.H0EventType_seasonality$fitted + residuals.H0EventType_seasonality
T_EventType_seasonality[perm] <- summary.aov(aov(TotalItems.perm.H0EventType_seasonality ~ seasonality + EventType + EventType_seasonality))[[1]][3,4]
}
sum(T_EventType_seasonality >= T0_EventType_seasonality)/B #EventType_continent not significant
# TEST OF FACTOR Seasonality   (H0: alpha=0)
T0_seasonalityt <- summary.aov(aov(North_America$TotalItems ~ seasonality + EventType))[[1]][1,4]
# residuals under H0:
# ratio = mu + beta*EventType
aov.H0seasonality <- aov(North_America$TotalItems  ~  EventType)
residuals.H0seasonality <- aov.H0seasonality$residuals
# TEST OF FACTOR EventType   (H0: beta=0)
T0_EventType <- summary.aov(aov(North_America$TotalItems ~ seasonality + EventType))[[1]][2,4]
# residuals under H0:
# ratio = mu + alpha*continent
aov.H0EventType <- aov(North_America$TotalItems ~ seasonality)
residuals.H0EventType <- aov.H0EventType$residuals
# TEST OF FACTOR Seasonality ANF TEST OF FACTOR EventType
# p-values
B <- 1000
T_seasonality  <- T_EventType <- numeric(B)
for(perm in 1:B){
permutation <- sample(n)
Totalitems.perm.H0seasonality <- aov.H0seasonality$fitted + residuals.H0seasonality[permutation]
T_seasonality[perm] <- summary.aov(aov(Totalitems.perm.H0seasonality  ~ seasonality + EventType))[[1]][1,4]
Totalitems.perm.H0EventType <- aov.H0EventType$fitted + residuals.H0EventType[permutation]
T_EventType[perm] <- summary.aov(aov(ratio.perm.H0EventType ~ seasonality + EventType))[[1]][2,4]
}
# TEST OF FACTOR Seasonality ANF TEST OF FACTOR EventType
# p-values
B <- 1000
T_seasonality  <- T_EventType <- numeric(B)
for(perm in 1:B){
permutation <- sample(n)
Totalitems.perm.H0seasonality <- aov.H0seasonality$fitted + residuals.H0seasonality[permutation]
T_seasonality[perm] <- summary.aov(aov(Totalitems.perm.H0seasonality  ~ seasonality + EventType))[[1]][1,4]
Totalitems.perm.H0EventType <- aov.H0EventType$fitted + residuals.H0EventType[permutation]
T_EventType[perm] <- summary.aov(aov(Totalitems.perm.H0EventType ~ seasonality + EventType))[[1]][2,4]
}
sum(T_seasonality >= T0_seasonality)/B #continent not significant
sum(T_EventType >= T0_EventType)/B #EventType not significant
# TEST OF FACTOR Seasonality   (H0: alpha=0)
T0_seasonality <- summary.aov(aov(North_America$TotalItems ~ seasonality + EventType))[[1]][1,4]
# residuals under H0:
# ratio = mu + beta*EventType
aov.H0seasonality <- aov(North_America$TotalItems  ~  EventType)
residuals.H0seasonality <- aov.H0seasonality$residuals
# TEST OF FACTOR EventType   (H0: beta=0)
T0_EventType <- summary.aov(aov(North_America$TotalItems ~ seasonality + EventType))[[1]][2,4]
# residuals under H0:
# ratio = mu + alpha*continent
aov.H0EventType <- aov(North_America$TotalItems ~ seasonality)
residuals.H0EventType <- aov.H0EventType$residuals
# TEST OF FACTOR Seasonality ANF TEST OF FACTOR EventType
# p-values
B <- 1000
T_seasonality  <- T_EventType <- numeric(B)
for(perm in 1:B){
permutation <- sample(n)
Totalitems.perm.H0seasonality <- aov.H0seasonality$fitted + residuals.H0seasonality[permutation]
T_seasonality[perm] <- summary.aov(aov(Totalitems.perm.H0seasonality  ~ seasonality + EventType))[[1]][1,4]
Totalitems.perm.H0EventType <- aov.H0EventType$fitted + residuals.H0EventType[permutation]
T_EventType[perm] <- summary.aov(aov(Totalitems.perm.H0EventType ~ seasonality + EventType))[[1]][2,4]
}
sum(T_seasonality >= T0_seasonality)/B #seasonality not significant
sum(T_EventType >= T0_EventType)/B #EventType not significant
10/100
fit <- aov(North_America$TotalItems ~ seasonality)
summary(fit)
T0 <- summary(fit)[[1]][1,4]
T0
B = 1000
seed = 26111992
T_stat <- numeric(B)
n <- length(North_America$seasonality)
for(perm in 1:B){
# Permutation:
permutation <- sample(1:n)
TotalItems <- North_America$TotalItems[permutation]
fit_perm <- aov(North_America$TotalItems ~ seasonality)
# Test statistic:
T_stat[perm] <- summary(fit_perm)[[1]][1,4]
}
p_val <- sum(T_stat>=T0)/B
p_val #seasonality NON significativa.
T0_seasonality <- summary.aov(aov(North_America$TotalItems ~ seasonality + EventType))[[1]][1,4]
# residuals under H0:
# TotalItems = mu + beta*EventType
aov.H0seasonality <- aov(North_America$TotalItems  ~  EventType)
residuals.H0seasonality <- aov.H0seasonality$residuals
# TEST OF FACTOR EventType   (H0: beta=0)
T0_EventType <- summary.aov(aov(North_America$TotalItems ~ seasonality + EventType))[[1]][2,4]
# residuals under H0:
# TotalItems = mu + alpha*seasonality
aov.H0EventType <- aov(North_America$TotalItems ~ seasonality)
residuals.H0EventType <- aov.H0EventType$residuals
# TEST OF FACTOR Seasonality ANF TEST OF FACTOR EventType
# p-values
B <- 1000
T_seasonality  <- T_EventType <- numeric(B)
for(perm in 1:B){
permutation <- sample(n)
Totalitems.perm.H0seasonality <- aov.H0seasonality$fitted + residuals.H0seasonality[permutation]
T_seasonality[perm] <- summary.aov(aov(Totalitems.perm.H0seasonality  ~ seasonality + EventType))[[1]][1,4]
Totalitems.perm.H0EventType <- aov.H0EventType$fitted + residuals.H0EventType[permutation]
T_EventType[perm] <- summary.aov(aov(Totalitems.perm.H0EventType ~ seasonality + EventType))[[1]][2,4]
}
sum(T_seasonality >= T0_seasonality)/B #seasonality significant
sum(T_EventType >= T0_EventType)/B #EventType significant
#se fissiamo alpha=0.05 seasonality e EventType sono significativi
# TEST OF FACTOR Seasonality   (H0: alpha=0)
T0_seasonality <- summary.aov(aov(North_America$ratio ~ seasonality + EventType))[[1]][1,4]
# residuals under H0:
# TotalItems = mu + beta*EventType
aov.H0seasonality <- aov(North_America$ratio  ~  EventType)
residuals.H0seasonality <- aov.H0seasonality$residuals
# TEST OF FACTOR EventType   (H0: beta=0)
T0_EventType <- summary.aov(aov(North_America$ratio ~ seasonality + EventType))[[1]][2,4]
# residuals under H0:
# TotalItems = mu + alpha*seasonality
aov.H0EventType <- aov(North_America$ratio ~ seasonality)
residuals.H0EventType <- aov.H0EventType$residuals
# TEST OF FACTOR Seasonality ANF TEST OF FACTOR EventType
# p-values
B <- 1000
T_seasonality  <- T_EventType <- numeric(B)
for(perm in 1:B){
permutation <- sample(n)
Totalitems.perm.H0seasonality <- aov.H0seasonality$fitted + residuals.H0seasonality[permutation]
T_seasonality[perm] <- summary.aov(aov(Totalitems.perm.H0seasonality  ~ seasonality + EventType))[[1]][1,4]
Totalitems.perm.H0EventType <- aov.H0EventType$fitted + residuals.H0EventType[permutation]
T_EventType[perm] <- summary.aov(aov(Totalitems.perm.H0EventType ~ seasonality + EventType))[[1]][2,4]
}
sum(T_seasonality >= T0_seasonality)/B #seasonality significant
sum(T_EventType >= T0_EventType)/B #EventType significant
summary.aov(aov(North_America$ratio ~ seasonality + EventType + EventType_seasonality))
summary.aov(aov(North_America$ratio ~ seasonality + EventType + EventType_seasonality))
# Without interaction
summary.aov(aov(North_America$ratio ~ seasonality + EventType))
T0_EventType_seasonality <- summary.aov(aov(North_America$ratio ~ seasonality + EventType + EventType_seasonality))[[1]][3,4]
T0_EventType_seasonality
aov.H0EventType_seasonality <- aov(North_America$ratio ~ seasonality + EventType)
aov.H0EventType_seasonality
residuals.H0EventType_seasonality <- aov.H0EventType_seasonality$residuals
n <- length(North_America$TotalItems)
T_EventType_seasonality  <- numeric(B)
for(perm in 1:B){
permutation <- sample(n)
residuals.H0EventType_seasonality <- residuals.H0EventType_seasonality[permutation]
TotalItems.perm.H0EventType_seasonality <- aov.H0EventType_seasonality$fitted + residuals.H0EventType_seasonality
T_EventType_seasonality[perm] <- summary.aov(aov(TotalItems.perm.H0EventType_seasonality ~ seasonality + EventType + EventType_seasonality))[[1]][3,4]
}
sum(T_EventType_seasonality >= T0_EventType_seasonality)/B #EventType_seasonality not significant
as.factor(Year)
#TWO-WAYS ANOVA
month_year=as.factor(North_America$Year):as.factor(North_America$Month)
month_year
summary.aov(aov(North_America$TotalItems ~ Year+ Month + month_year))
#TWO-WAYS ANOVA
Year=as.factor(North_America$Year)
Month=as.factor(North_America$Month)
month_year=as.factor(North_America$Year):as.factor(North_America$Month)
summary.aov(aov(North_America$TotalItems ~ Year+ Month + month_year))
Year=as.factor(North_America$Year)
Month=as.factor(North_America$Month)
month_year=as.factor(North_America$Year):as.factor(North_America$Month)
summary.aov(aov(North_America$TotalItems ~ Year+ Month + month_year))
# Without interaction
summary.aov(aov(North_America$TotalItems ~ Year+ Month + EventType))
T0_month_year <- summary.aov(aov(North_America$TotalItems ~ Year+ Month + month_year))[[1]][3,4]
T0_month_year
aov.H0T0_month_year <- aov(North_America$TotalItems ~ Year+ Month)
aov.H0T0_month_year
residuals.H0month_year <- aov.H0month_year$residuals
n <- length(North_America$TotalItems)
T_month_year  <- numeric(B)
for(perm in 1:B){
permutation <- sample(n)
residuals.H0month_year <- residuals.H0month_year[permutation]
TotalItems.perm.H0month_year <- aov.H0month_year$fitted + residuals.H0month_year
T_month_year[perm] <- summary.aov(aov(TotalItems.perm.H0month_year ~ Year+ Month + month_year))[[1]][3,4]
}
sum(T_month_year >= T0_month_year)/B
# Without interaction
summary.aov(aov(North_America$TotalItems ~ Year+ Month + EventType))
T0_month_year <- summary.aov(aov(North_America$TotalItems ~ Year+ Month + month_year))[[1]][3,4]
T0_month_year
aov.H0month_year <- aov(North_America$TotalItems ~ Year+ Month)
aov.H0month_year
residuals.H0month_year <- aov.H0month_year$residuals
n <- length(North_America$TotalItems)
T_month_year  <- numeric(B)
for(perm in 1:B){
permutation <- sample(n)
residuals.H0month_year <- residuals.H0month_year[permutation]
TotalItems.perm.H0month_year <- aov.H0month_year$fitted + residuals.H0month_year
T_month_year[perm] <- summary.aov(aov(TotalItems.perm.H0month_year ~ Year+ Month + month_year))[[1]][3,4]
}
sum(T_month_year >= T0_month_year)/B #month_year not significant
for(perm in 1:B){
permutation <- sample(n)
residuals.H0month_year <- residuals.H0month_year[permutation]
TotalItems.perm.H0month_year <- aov.H0month_year$fitted + residuals.H0month_year
T_month_year[perm] <- summary.aov(aov(TotalItems.perm.H0month_year ~ Year + Month + month_year))[[1]][3,4]
}
sum(T_month_year >= T0_month_year)/B #month_year not significant
# Without interaction
summary.aov(aov(North_America$TotalItems ~ Year+ Month + EventType))
summary.aov(aov(North_America$TotalItems ~ Year+ Month + month_year))
# Without interaction
summary.aov(aov(North_America$TotalItems ~ Year+ Month))
T0_month_year <- summary.aov(aov(North_America$TotalItems ~ Year + Month + month_year))[[1]][3,4]
T0_month_year
aov.H0month_year <- aov(North_America$TotalItems ~ Year+ Month)
aov.H0month_year
residuals.H0month_year <- aov.H0month_year$residuals
n <- length(North_America$TotalItems)
T_month_year  <- numeric(B)
for(perm in 1:B){
permutation <- sample(n)
residuals.H0month_year <- residuals.H0month_year[permutation]
TotalItems.perm.H0month_year <- aov.H0month_year$fitted + residuals.H0month_year
T_month_year[perm] <- summary.aov(aov(TotalItems.perm.H0month_year ~ Year + Month + month_year))[[1]][3,4]
}
sum(T_month_year >= T0_month_year)/B #month_year significant
sum(T_month_year >= T0_month_year)/B #month_year significant se fissiamo alpha=0.05 o 0.1
B=500
T_month_year  <- numeric(B)
for(perm in 1:B){
permutation <- sample(n)
residuals.H0month_year <- residuals.H0month_year[permutation]
TotalItems.perm.H0month_year <- aov.H0month_year$fitted + residuals.H0month_year
T_month_year[perm] <- summary.aov(aov(TotalItems.perm.H0month_year ~ Year + Month + month_year))[[1]][3,4]
}
sum(T_month_year >= T0_month_year)/B #month_year significant se fissiamo alpha=0.05 o 0.1
B=1000
fit <- aov(North_America$TotalItems ~ Year)
summary(fit)
T0 <- summary(fit)[[1]][1,4]
T0
B = 1000
seed = 26111992
T_stat <- numeric(B)
n <- length(North_America$seasonality)
fit_perm <- aov(North_America$TotalItems ~ Year)
for(perm in 1:B){
# Permutation:
permutation <- sample(1:n)
TotalItems <- North_America$TotalItems[permutation]
fit_perm <- aov(North_America$TotalItems ~ Year)
# Test statistic:
T_stat[perm] <- summary(fit_perm)[[1]][1,4]
}
p_val <- sum(T_stat>=T0)/B
p_val #seasonality NON significativa.
#MONTH
fit <- aov(North_America$TotalItems ~ Month)
summary(fit)
T0 <- summary(fit)[[1]][1,4]
T0
B = 1000
seed = 26111992
T_stat <- numeric(B)
n <- length(North_America$seasonality)
for(perm in 1:B){
# Permutation:
permutation <- sample(1:n)
TotalItems <- North_America$TotalItems[permutation]
fit_perm <- aov(North_America$TotalItems ~ Month)
# Test statistic:
T_stat[perm] <- summary(fit_perm)[[1]][1,4]
}
p_val <- sum(T_stat>=T0)/B
p_val #Year NON significativa.
seasonality
#YEAR\SEASONALITY
#TWO-WAYS ANOVA
seasonality_year=as.factor(seasonality):as.factor(North_America$Year)
seasonality_year
seasonality
#YEAR\SEASONALITY
#TWO-WAYS ANOVA
seasonality=as.factor(seasonality)
seasonality
Year
seasonality
#YEAR\SEASONALITY
#TWO-WAYS ANOVA
seasonality=as.factor(seasonality)
seasonality_year=as.factor(seasonality):as.factor(North_America$Year)
summary.aov(aov(North_America$TotalItems ~ Year + seasonality + seasonality_year))
# Without interaction
summary.aov(aov(North_America$TotalItems ~ Year + seasonality))
T0_seasonality_year <- summary.aov(aov(North_America$TotalItems ~ Year + seasonality + seasonality_year))[[1]][3,4]
T0_seasonality_year
aov.H0seasonality_year <- aov(North_America$TotalItems ~ Year + seasonality)
aov.H0seasonality_year
residuals.H0seasonality_year <- aov.H0seasonality_year$residuals
n <- length(North_America$TotalItems)
T_month_year  <- numeric(B)
for(perm in 1:B){
permutation <- sample(n)
residuals.H0seasonality_year <- residuals.H0seasonality_year[permutation]
TotalItems.perm.H0seasonality_year <- aov.H0seasonality_year$fitted + residuals.H0seasonality_year
T_seasonality_year[perm] <- summary.aov(aov(TotalItems.perm.H0seasonality_year ~ Year + seasonality + seasonality_year))[[1]][3,4]
}
T_seasonality_year  <- numeric(B)
for(perm in 1:B){
permutation <- sample(n)
residuals.H0seasonality_year <- residuals.H0seasonality_year[permutation]
TotalItems.perm.H0seasonality_year <- aov.H0seasonality_year$fitted + residuals.H0seasonality_year
T_seasonality_year[perm] <- summary.aov(aov(TotalItems.perm.H0seasonality_year ~ Year + seasonality + seasonality_year))[[1]][3,4]
}
sum(T_seasonality_year >= T0_seasonality_year)/B #month_year significant se fissiamo alpha=0.05 o 0.1
seasonality
seasonality=as.factor(seasonality)
fit <- aov(North_America$TotalItems ~ seasonality)
summary(fit)
T0 <- summary(fit)[[1]][1,4]
T0
B = 1000
seed = 26111992
T_stat <- numeric(B)
n <- length(North_America$seasonality)
for(perm in 1:B){
# Permutation:
permutation <- sample(1:n)
TotalItems <- North_America$TotalItems[permutation]
fit_perm <- aov(North_America$TotalItems ~ seasonality)
# Test statistic:
T_stat[perm] <- summary(fit_perm)[[1]][1,4]
}
p_val <- sum(T_stat>=T0)/B
p_val #seasonality NON significativa.
EventType
#TWO-WAYS ANOVA
EventType_seasonality=as.factor(seasonality):EventType
summary.aov(aov(North_America$TotalItems ~ seasonality + EventType + EventType_seasonality))
# Without interaction
summary.aov(aov(North_America$TotalItems ~ seasonality + EventType))
T0_EventType_seasonality <- summary.aov(aov(North_America$TotalItems ~ seasonality + EventType + EventType_seasonality))[[1]][3,4]
T0_EventType_seasonality
aov.H0EventType_seasonality <- aov(North_America$TotalItems ~ seasonality + EventType)
aov.H0EventType_seasonality
residuals.H0EventType_seasonality <- aov.H0EventType_seasonality$residuals
n <- length(North_America$TotalItems)
T_EventType_seasonality  <- numeric(B)
for(perm in 1:B){
permutation <- sample(n)
residuals.H0EventType_seasonality <- residuals.H0EventType_seasonality[permutation]
TotalItems.perm.H0EventType_seasonality <- aov.H0EventType_seasonality$fitted + residuals.H0EventType_seasonality
T_EventType_seasonality[perm] <- summary.aov(aov(TotalItems.perm.H0EventType_seasonality ~ seasonality + EventType + EventType_seasonality))[[1]][3,4]
}
sum(T_EventType_seasonality >= T0_EventType_seasonality)/B #EventType_seasonality not significant
# TEST OF FACTOR Seasonality   (H0: alpha=0)
T0_seasonality <- summary.aov(aov(North_America$TotalItems ~ seasonality + EventType))[[1]][1,4]
# residuals under H0:
# TotalItems = mu + beta*EventType
aov.H0seasonality <- aov(North_America$TotalItems  ~  EventType)
residuals.H0seasonality <- aov.H0seasonality$residuals
# TEST OF FACTOR EventType   (H0: beta=0)
T0_EventType <- summary.aov(aov(North_America$TotalItems ~ seasonality + EventType))[[1]][2,4]
# residuals under H0:
# TotalItems = mu + alpha*seasonality
aov.H0EventType <- aov(North_America$TotalItems ~ seasonality)
residuals.H0EventType <- aov.H0EventType$residuals
# TEST OF FACTOR Seasonality ANF TEST OF FACTOR EventType
# p-values
B <- 1000
T_seasonality  <- T_EventType <- numeric(B)
for(perm in 1:B){
permutation <- sample(n)
Totalitems.perm.H0seasonality <- aov.H0seasonality$fitted + residuals.H0seasonality[permutation]
T_seasonality[perm] <- summary.aov(aov(Totalitems.perm.H0seasonality  ~ seasonality + EventType))[[1]][1,4]
Totalitems.perm.H0EventType <- aov.H0EventType$fitted + residuals.H0EventType[permutation]
T_EventType[perm] <- summary.aov(aov(Totalitems.perm.H0EventType ~ seasonality + EventType))[[1]][2,4]
}
sum(T_seasonality >= T0_seasonality)/B #seasonality significant
sum(T_EventType >= T0_EventType)/B #EventType significant
fit <- aov(cleandata$TotalItems ~ EventType)
summary(fit) #TotalItems indipendente da EventType usando ANOVA che però non possiamo usare perche ipotesi violate
#chiaramente non gaussiani, violazione ipotesi per ANOVA
EventType=as.factor(cleandata$EventType)
fit <- aov(cleandata$TotalItems ~ EventType)
summary(fit) #TotalItems indipendente da EventType usando ANOVA che però non possiamo usare perche ipotesi violate
library(rio)
library(roahd)
library(rgl)
library(MASS)
library(rgl)
library(DepthProc)
library(hexbin)
library(packagefinder)
library(aplpack)
library(robustbase)
current_path=rstudioapi::getActiveDocumentContext()$path
setwd(dirname(current_path))
cleandata=import("cleandata.Rdata")
cleandata=cleandata[which(cleandata$Year!="2015"),] #dataset finale 38953 osservazioni, 2015 ha solo  1411 osservazioni
dim(cleandata[which(cleandata$Year=="2016"),])[1] #9273 osservazioni nel 2016
dim(cleandata[which(cleandata$Year=="2017"),])[1] #12296 osservazioni nel 2016
dim(cleandata[which(cleandata$Year=="2018"),])[1] #17384 osservazioni nel 2016
#new dataset
stati = aggregate(cleandata$TotalItems, by=list(Country=cleandata$Country, month=cleandata$MonthNum, year=cleandata$Year), FUN=sum)
nomi_stati = levels(factor(cleandata$Country))
zeros = rep(0, length(nomi_stati))
stati_fda = data.frame(nomi_stati)
#dataframe stati/mesi
count = 1
for (y in 2016:2018){
for (i in 1:12){
stati_fda = cbind(stati_fda, zeros);
temp = stati[which(stati$month==i & stati$year==y), ]
index = match(temp$Country, stati_fda$nomi_stati)
stati_fda[index, count+1] = temp$x
count = count+1
}
}
names(stati_fda) =  as.character(c('Country', 1:(12*3)))
for (i in 1:127) {
x=0;
for (t in 1:36) {
if(stati_fda[i,1+t]!=0)
x=x+1;
}
if(x>=24)
zeros[i]=1
}
sum(zeros) #11 stati su 127 che hanno ALMENO 24 mesi su 36 (2 anni su 3) di dati
# plot functional data
matplot(t(stati_fda[ ,-1]), type='l')
North_America=cleandata[which(cleandata$Continent=='North America'),] #30108 dati su 38953 totali
subcountry = aggregate(North_America$TotalItems, by=list(SubCountry=North_America$SubCountry1, day=North_America$Day, month=North_America$MonthNum, year=North_America$Year), FUN=sum)
nomi_subcountry = levels(factor(North_America$SubCountry1))
zeros = rep(0, length(nomi_subcountry))
subcountry_fda = data.frame(nomi_subcountry)
#dataframe SubCountry/giorni
count = 1;
subcountry_fda = data.frame(matrix(0,nrow=263,ncol=1096))
subcountry_fda[,1]=data.frame(nomi_subcountry)
names(subcountry_fda) =  as.character(c('SubCountry', rep(c(1:31,1:28,1:31,1:30,1:31,1:30,1:31,1:31,1:30,1:31,1:30,1:31),3)))
for (y in 2016:2018){
for (x in 1:12){
if(x==1||x==3||x==5||x==3||x==7||x==8||x==10||x==12){
for (i in 1:31){
temp = subcountry[which(subcountry$day==i & subcountry$month==x & subcountry$year==y), ]
index = match(temp$SubCountry, subcountry_fda$SubCountry)
subcountry_fda[index, count+1] = temp$x
count = count+1
}}
if(x==2){
for (i in 1:28){
temp = subcountry[which(subcountry$day==i & subcountry$month==x & subcountry$year==y), ]
index = match(temp$SubCountry, subcountry_fda$SubCountry)
subcountry_fda[index, count+1] = temp$x
count = count+1
}}
if(x==4||x==6||x==9||x==11){
for (i in 1:30){
temp = subcountry[which(subcountry$day==i & subcountry$month==x & subcountry$year==y), ]
index = match(temp$SubCountry, subcountry_fda$SubCountry)
subcountry_fda[index, count+1] = temp$x
count = count+1
}}
}
}
data_fun = fData(1:(365*3), subcountry_fda[ ,-1])
plot(data_fun)
rm(list=ls())
library(maps)
library(maptools)
library(rgdal)
library(sp)
library(shp2graph)
library(lubridate)
setwd("~/Documents/GitHub/NPS-project/TM_WORLD_BORDERS_SIMPL-0")
shape2 =readOGR("TM_WORLD_BORDERS_SIMPL-0.3.shp")
plot(shape2)
summary(shape2)
shape2$NAME
Nord_America = shape2[which(shape2$NAME=='United States')]
Nord_America = shape2[which(shape2$NAME=='USA')]
plot(Nord_America)
Nord_America = shape2[which(shape2$NAME=='USA'), ]
plot(Nord_America)
Nord_America = shape2[which(shape2@data$NAME=='USA'), ]
plot(Nord_America)
which(shape2@data$NAME=='USA')
shape2@data$NAME
Nord_America = shape2[which(shape2@data$NAME=='Georgia'), ]
plot(Nord_America)
