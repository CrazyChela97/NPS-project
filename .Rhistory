count = 1
for (y in 2015:2018){
for (i in 1:12){
stati_fda = cbind(stati_fda, zeros);
temp = stati[which(stati$month==i & stati$year==y), ]
index = match(temp$Country, stati_fda$nomi_stati)
stati_fda[index, count+1] = temp$x
count = count+1
}
}
names(stati_fda) =  as.character(c('Country', 1:(12*4)))
# plot functional data
matplot(t(stati_fda[ ,-1]), type='l')
# con pacchetto roahd
data_fun = fData(1:(12*4), stati_fda[ ,-1])
plot(data_fun)
# plotto andamento USA
USA = stati_fda[which(stati_fda$Country=='USA'), ]
data_fun = fData(1:(12*4), USA[ ,-1])
plot(data_fun)
# plotto andamento USA
USA = stati_fda[which(stati_fda$Country=='USA'), ]
data_fun = fData(1:(12*4), USA[ ,-1])
plot(data_fun)
stati
stati
dati_2015$Totalltems_EventRecord
data$OBJECTID
stati
#dataframe stati/mesi
for (i in 1:12){
stati_fda = cbind(stati_fda, zeros);
temp = stati[which(stati$month==i), ]
index = match(temp$Country, stati_fda$nomi_stati)
stati_fda[index, i+1] = temp$x
}
dati_2015 = data[which(data$Year==2015), ]
stati = aggregate(dati_2015$Totalltems_EventRecord, by=list(Country=dati_2015$CountryName_FromSource, month=dati_2015$MonthNum), FUN=sum)
nomi_stati = levels(factor(dati_2015$CountryName_FromSource))
zeros = rep(0, length(nomi_stati))
stati_fda = data.frame(nomi_stati)
#dataframe stati/mesi
for (i in 1:12){
stati_fda = cbind(stati_fda, zeros);
temp = stati[which(stati$month==i), ]
index = match(temp$Country, stati_fda$nomi_stati)
stati_fda[index, i+1] = temp$x
}
stati
dati_2015
dati_2015[1:10,c(dati_2015$CountryName_FromSource,dati_2015$Totalltems_EventRecord)]
dati_2015[1:10,]
dati_2015$Organization
dati_2015$CountryName_FromSource
dati_2015$RecordSequenceID
dati_2015$OBJECTID
dati_2015$Month
dati_2015$MonthNum
dati_2015$TotalClassifiedItems_EC2020
dati_2015
dati_2015$Totalltems_EventRecord
dati_2015$TotalClassifiedItems_EC2020
dati_2015$PCT_PlasticAndFoam
dati_2015$PCT_Glass_Rubber_Lumber_Metal
dati_2015$ShorelineName
stati
nomi_stati
nomi_stati[1]
nomi_stati[38]
stati
dati_2015
stati = aggregate(dati_2015$Totalltems_EventRecord, by=list(Country=dati_2015$CountryName_FromSource, month=dati_2015$MonthNum), FUN=sum)
stati
#dataframe stati/mesi
for (i in 1:12){
stati_fda = cbind(stati_fda, zeros);
temp = stati[which(stati$month==i), ]
index = match(temp$Country, stati_fda$nomi_stati)
stati_fda[index, i+1] = temp$x
}
names(stati_fda) =  as.character(c('Country', 1:12))
# plot functional data
matplot(t(stati_fda[ ,-1]), type='l')
for (i in 1:12){
stati_fda = cbind(stati_fda, zeros);
temp = stati[which(stati$month==i), ]
index = match(temp$Country, stati_fda$nomi_stati)
stati_fda[index, i+1] = temp$x
}
names(stati_fda) =  as.character(c('Country', 1:12))
# plot functional data
matplot(t(stati_fda[ ,-1]), type='l')
title('Country/Month 2015')
dati_2015 = data[which(data$Year==2015), ]
stati = aggregate(dati_2015$Totalltems_EventRecord, by=list(Country=dati_2015$CountryName_FromSource, month=dati_2015$MonthNum), FUN=sum)
nomi_stati = levels(factor(dati_2015$CountryName_FromSource))
zeros = rep(0, length(nomi_stati))
stati_fda = data.frame(nomi_stati)
#dataframe stati/mesi
for (i in 1:12){
stati_fda = cbind(stati_fda, zeros);
temp = stati[which(stati$month==i), ]
index = match(temp$Country, stati_fda$nomi_stati)
stati_fda[index, i+1] = temp$x
}
names(stati_fda) =  as.character(c('Country', 1:12))
# plot functional data
matplot(t(stati_fda[ ,-1]), type='l')
stati
# plotto andamento USA
USA = stati_fda[which(stati_fda$Country=='DK'), ]
data_fun = fData(1:(12*4), DK[ ,-1])
# plotto andamento USA
USA = stati_fda[which(stati_fda$Country=='DK'), ]
data_fun = fData(1:(12*4), DK[ ,-1])
plot(data_fun)
#### provo su tutto dataset
stati = aggregate(data$Totalltems_EventRecord, by=list(Country=data$CountryName_FromSource, month=data$MonthNum, year=data$Year), FUN=sum)
nomi_stati = levels(factor(data$CountryName_FromSource))
zeros = rep(0, length(nomi_stati))
stati_fda = data.frame(nomi_stati)
#dataframe stati/mesi
count = 1
for (y in 2015:2018){
for (i in 1:12){
stati_fda = cbind(stati_fda, zeros);
temp = stati[which(stati$month==i & stati$year==y), ]
index = match(temp$Country, stati_fda$nomi_stati)
stati_fda[index, count+1] = temp$x
count = count+1
}
}
names(stati_fda) =  as.character(c('Country', 1:(12*4)))
# plotto andamento USA
USA = stati_fda[which(stati_fda$Country=='DK'), ]
data_fun = fData(1:(12*4), DK[ ,-1])
data_fun = fData(1:(12*4), USA[ ,-1])
plot(data_fun)
stati
# plotto andamento USA
USA = stati_fda[which(stati_fda$Country=='DK'), ]
data_fun = fData(1:(12*4), USA[ ,-1])
plot(data_fun)
# plotto andamento USA
USA = stati_fda[which(stati_fda$Country=='USA'), ]
data_fun = fData(1:(12*4), USA[ ,-1])
plot(data_fun)
#### provo su tutto dataset
stati = aggregate(data$Totalltems_EventRecord, by=list(Country=data$CountryName_FromSource, month=data$MonthNum, year=data$Year), FUN=sum)
nomi_stati = levels(factor(data$CountryName_FromSource))
zeros = rep(0, length(nomi_stati))
stati_fda = data.frame(nomi_stati)
# prova dataset 2015 stati/mesi
dati_2015 = data[which(data$Year==2015), ]
stati = aggregate(dati_2015$Totalltems_EventRecord, by=list(Country=dati_2015$CountryName_FromSource, month=dati_2015$MonthNum), FUN=sum)
nomi_stati = levels(factor(dati_2015$CountryName_FromSource))
zeros = rep(0, length(nomi_stati))
stati_fda = data.frame(nomi_stati)
stati
#dataframe stati/mesi
for (i in 1:12){
stati_fda = cbind(stati_fda, zeros);
temp = stati[which(stati$month==i), ]
index = match(temp$Country, stati_fda$nomi_stati)
stati_fda[index, i+1] = temp$x
}
names(stati_fda) =  as.character(c('Country', 1:12))
# plot functional data
matplot(t(stati_fda[ ,-1]), type='l')
#### provo su tutto dataset
stati = aggregate(data$Totalltems_EventRecord, by=list(Country=data$CountryName_FromSource, month=data$MonthNum, year=data$Year), FUN=sum)
nomi_stati = levels(factor(data$CountryName_FromSource))
zeros = rep(0, length(nomi_stati))
stati_fda = data.frame(nomi_stati)
#dataframe stati/mesi
count = 1
for (y in 2015:2018){
for (i in 1:12){
stati_fda = cbind(stati_fda, zeros);
temp = stati[which(stati$month==i & stati$year==y), ]
index = match(temp$Country, stati_fda$nomi_stati)
stati_fda[index, count+1] = temp$x
count = count+1
}
}
names(stati_fda) =  as.character(c('Country', 1:(12*4)))
# plot functional data
matplot(t(stati_fda[ ,-1]), type='l')
# plotto andamento USA
USA = stati_fda[which(stati_fda$Country=='USA'), ]
data_fun = fData(1:(12*4), USA[ ,-1])
plot(data_fun)
max(data_fun)
USA[ ,-1]
max(USA[,-1])
#### provo su tutto dataset
stati = aggregate(data$Totalltems_EventRecord, by=list(Country=data$CountryName_FromSource, month=data$MonthNum, year=data$Year), FUN=sum)
nomi_stati = levels(factor(data$CountryName_FromSource))
zeros = rep(0, length(nomi_stati))
stati_fda = data.frame(nomi_stati)
#dataframe stati/mesi
count = 1
for (y in 2015:2018){
for (i in 1:12){
stati_fda = cbind(stati_fda, zeros);
temp = stati[which(stati$month==i & stati$year==y), ]
index = match(temp$Country, stati_fda$nomi_stati)
stati_fda[index, count+1] = temp$x
count = count+1
}
}
names(stati_fda) =  as.character(c('Country', 1:(12*4)))
# plot functional data
matplot(t(stati_fda[ ,-1]), type='l')
stati_fda
max(stati_fda[ ,-1])
max(stati_fda[ ,"USA"])
zeros
length(nomi_stati)
# prova dataset 2015 stati/mesi
dati_2015 = data[which(data$Year==2015), ]
stati = aggregate(dati_2015$Totalltems_EventRecord, by=list(Country=dati_2015$CountryName_FromSource, month=dati_2015$MonthNum), FUN=sum)
nomi_stati = levels(factor(dati_2015$CountryName_FromSource))
zeros = rep(0, length(nomi_stati))
length(nomi_stati)
# prova dataset 2015 stati/mesi
dati_2015 = data[which(data$Year=="2016"), ]
stati = aggregate(dati_2015$Totalltems_EventRecord, by=list(Country=dati_2015$CountryName_FromSource, month=dati_2015$MonthNum), FUN=sum)
nomi_stati = levels(factor(dati_2015$CountryName_FromSource))
zeros = rep(0, length(nomi_stati))
length(nomi_stati)
# prova dataset 2015 stati/mesi
dati_2015 = data[which(data$Year=="2017"), ]
stati = aggregate(dati_2015$Totalltems_EventRecord, by=list(Country=dati_2015$CountryName_FromSource, month=dati_2015$MonthNum), FUN=sum)
nomi_stati = levels(factor(dati_2015$CountryName_FromSource))
zeros = rep(0, length(nomi_stati))
length(nomi_stati)
# prova dataset 2015 stati/mesi
dati_2015 = data[which(data$Year=="2018"), ]
stati = aggregate(dati_2015$Totalltems_EventRecord, by=list(Country=dati_2015$CountryName_FromSource, month=dati_2015$MonthNum), FUN=sum)
nomi_stati = levels(factor(dati_2015$CountryName_FromSource))
zeros = rep(0, length(nomi_stati))
length(nomi_stati)
117-138
stati_fda[ ,]
stati_fda[which(max(stati_fda)) ,]
max(stati_fda)
max[stati_fda,-1]
stati
max(stati)
max(stati$x)
stati$Country[which(max(stati$x))]
stati[which(max(stati$x)),]
which(max(stati$x))
stati(max(stati$x))
stati[max(stati$x)]
max(stati$x)
stati[3,1:3]
stati[,which(stati$x==max(stati$x))]
which(stati$x==max(stati$x))
stati[which(stati$x==max(stati$x)),]
stati$Country[which(stati$x==max(stati$x)),]
stati[which(stati$x==max(stati$x)),1]
# palese outlier nel 2018, va trovato
stati[which(stati$x==max(stati$x)),1] #outlier Ghana
stati$x
max(stati$x))
max(stati$x)
which(stati$x==max(stati$x))
# palese outlier nel 2018, va trovato
stati[343,1] #outlier Ghana
# palese outlier nel 2018, va trovato
stati[which(stati$x==max(stati$x)),1] #outlier Ghana
stati_fda[ ,-1]
stati_fda[ ,]
# con pacchetto roahd
data_fun = fData(1:(12*4), stati_fda[ ,])
plot(data_fun)
# plot functional data
matplot(t(stati_fda[ ,]), type='l')
stati_fda
stati_fda[which(stati_fda$Country=='Ghana'),]
which(stati_fda$Country=='Ghana')
stati_fda[which(stati_fda$Country=='Ghana'),]
Ghana=stati_fda[which(stati_fda$Country=='Ghana'),]
sum(Ghana==0)
Ghana==0
Ghana=stati_fda[which(stati_fda$Country=='Ghana'),]
sum(Ghana==0) #42 su 48, solo 6 valori in 4 anni e uno di questi è il più alto tra tutti i paesi
sum(Ghana[,-1]==0) #42 su 48, solo 6 valori in 4 anni e uno di questi è il più alto tra tutti i paesi
Ghana[,-1]
sum(Ghana==0) #42 su 48, solo 6 valori in 4 anni e uno di questi è il più alto tra tutti i paesi
Ghana
which(stati_fda$Country=='Ghana')
matplot(t(stati_fda[-61 ,-1]), type='l')
# plot functional data
matplot(t(stati_fda[ ,-1]), type='l')
matplot(t(stati_fda[-61 ,-1]), type='l')
# plot functional data
matplot(t(stati_fda[ ,-1]), type='l')
# palese outlier nel 2018, va trovato
stati[which(stati$x==max(stati$x)),1] #outlier Ghana
stati
#nuovo dataset senza Ghana
stati_new=stati[-which(stati$x==max(stati$x)),]
stati_new
stati
stati_new
239-238
stati_new[which(stati$x==max(stati$x)),1]
matplot(t(stati_fda[-61 ,-1]), type='l')
Greece=stati_fda[which(stati_fda$Country=='Greece'),] #61 riga del Ghana
sum(Greece==0)
Greece
sum(Greece==0)
stati_fda$Country=='Greece')
which(stati_fda$Country=='Greece')
matplot(t(stati_fda[-c(61,63) ,-1]), type='l')
matplot(t(stati_fda[-61 ,-1]), type='l')
window()
matplot(t(stati_fda[-61 ,-1]), type='l')
matplot(t(stati_fda[-c(61,63) ,-1]), type='l')
which(stati_fda$Country=='Greece')
stati_fda
stati_fda[-c(61,63) ,-1])
stati_fda[-c(61,63) ,-1]
matplot(t(stati_fda[-61 ,-1]), type='l')
matplot(t(stati_fda[-c(61,63) ,-1]), type='l')
max(stati$x)
max(stati$x)
stati_new[which(stati_new$x==max(stati$x)),1]
stati_new[which(stati_new$x==max(stati$x)),1]
max(stati$x)
stati_new
stati_new
stati_new[which(stati_new$x==max(stati_new$x)),1]
#nuovo dataset senza Ghana
stati_new=stati[-which(stati$x==max(stati$x)),]
stati_new[which(stati_new$x==max(stati_new$x)),1]
stati
stati_new
stati
max(stati_new$x)
matplot(t(stati_fda[-61 ,-1]), type='l')
stati_new[which(stati_new$x==max(stati_new$x)),1]
Philippines=stati_fda[which(stati_fda$Country=='Philippines'),] #63 riga della Grecia
which(stati_fda$Country=='Philippines')
Philippines
sum(Philippines==0) #34 su 48, "solo" 14 valori
sum(Philippines==0) #22 su 48, 26 valori da metà del secondo anno in poi
matplot(t(stati_fda[-c(61,119) ,-1]), type='l')
matplot(t(stati_fda[-61 ,-1]), type='l')
matplot(t(stati_fda[-c(61,119) ,-1]), type='l')
matplot(t(stati_fda[-61 ,-1]), type='l')
matplot(t(stati_fda[-c(61,119) ,-1]), type='l')
stati_new1=stati[-which(stati_new$x==max(stati_new$x)),]
stati_new1
max(stati_new$x)
max(stati$x)
stati
#### provo su tutto dataset
stati = aggregate(data$Totalltems_EventRecord, by=list(Country=data$CountryName_FromSource, month=data$MonthNum, year=data$Year), FUN=sum)
nomi_stati = levels(factor(data$CountryName_FromSource))
zeros = rep(0, length(nomi_stati))
stati_fda = data.frame(nomi_stati)
#dataframe stati/mesi
count = 1
for (y in 2015:2018){
for (i in 1:12){
stati_fda = cbind(stati_fda, zeros);
temp = stati[which(stati$month==i & stati$year==y), ]
index = match(temp$Country, stati_fda$nomi_stati)
stati_fda[index, count+1] = temp$x
count = count+1
}
}
names(stati_fda) =  as.character(c('Country', 1:(12*4)))
# plot functional data
matplot(t(stati_fda[ ,-1]), type='l')
# palese outlier nel 2018, va trovato
stati[which(stati$x==max(stati$x)),1] #outlier Ghana
Ghana=stati_fda[which(stati_fda$Country=='Ghana'),] #61 riga del Ghana
sum(Ghana==0) #42 su 48, solo 6 valori in 4 anni e uno di questi è il più alto tra tutti i paesi
matplot(t(stati_fda[-61 ,-1]), type='l')
max(stati$x)
max(stati$x)
#nuovo dataset senza Ghana
stati_new=stati[-which(stati$x==max(stati$x)),]
stati_new[which(stati_new$x==max(stati_new$x)),1]
Philippines=stati_fda[which(stati_fda$Country=='Philippines'),] #119 riga delle Philippines
sum(Philippines==0) #22 su 48, 26 valori da metà del secondo anno in poi
matplot(t(stati_fda[-c(61,119) ,-1]), type='l')
stati_new1=stati[-which(stati_new$x==max(stati_new$x)),]
max(stati_new$x)
max(stati$x)
max(stati_new$x)
stati_fda$Country=='Philippines')
which(stati_fda$Country=='Philippines')
stati_new[which(stati_new$x==max(stati_new$x)),1]
max(stati_new$x)
max(stati_new$x)
stati_new1=stati_new[-which(stati_new$x==max(stati_new$x)),]
stati_new1
stati_new1=stati_new[-which(stati_new$x==max(stati_new$x)),1]
stati_new1
# palese outlier nel 2018, va trovato
stati[which(stati$x==max(stati$x)),1] #outlier Ghana
stati_new1[which(stati_new1$x==max(stati_new1$x)),1]
stati_new1=stati_new[-which(stati_new$x==max(stati_new$x)),]
stati_new1[which(stati_new1$x==max(stati_new1$x)),1]
# palese outlier nel 2018, va trovato
stati[which(stati$x==max(stati$x)),1] #outlier Ghana
#nuovo dataset senza Ghana
stati_new=stati[-which(stati$x==max(stati$x)),]
stati_new[which(stati_new$x==max(stati_new$x)),1]
stati_new1=stati_new[-which(stati_new$x==max(stati_new$x)),]
stati_new1[which(stati_new1$x==max(stati_new1$x)),1]
which(stati_new$x==max(stati_new$x))
which(stati$x==max(stati$x))
stati
# palese outlier nel 2018, va trovato
stati[which(stati$x==max(stati$x)),1] #outlier Ghana
Ghana=stati_fda[which(stati_fda$Country=='Ghana'),] #61 riga del Ghana
sum(Ghana==0) #42 su 48, solo 6 valori in 4 anni e uno di questi è il più alto tra tutti i paesi
which(stati$x==max(stati$x))
stati
stati[which(stati$x==max(stati$x)),]
stati[1244,]
which(stati$Country=='Ghana')
length(which(stati$Country=='Ghana'))
#nuovo dataset senza Ghana
stati_new=stati[-which(stati$Country=='Ghana'),]
stati_new[which(stati_new$x==max(stati_new$x)),1]
Philippines=stati_fda[which(stati_fda$Country=='Philippines'),] #119 riga delle Philippines
sum(Philippines==0) #22 su 48, 26 valori da metà del secondo anno in poi
which(stati$Country=='Philippines')
length(which(stati$Country=='Philippines'))
stati_new1=stati_new[-which(stati$Country=='Philippines'),]
stati_new1[which(stati_new1$x==max(stati_new1$x)),1]
stati_new1=stati_new[-which(stati$Country=='Philippines'),]
stati_new1[which(stati_new1$x==max(stati_new1$x)),1]
which(stati_new1$x==max(stati_new1$x))
stati_new1
stati
stati_new
1216-26
stati_new1
stati_new[which(stati_new$x==max(stati_new$x)),1]
which(stati$Country=='Philippines')
stati_new1=stati_new[-which(stati$Country=='Philippines'),]
stati_new1[1191,]
stati_new1[209,]
max(stati_new1$x)
max(stati_new$x)
matplot(t(stati_fda[-c(61,119) ,-1]), type='l')
matplot(t(stati_fda[-61 ,-1]), type='l')
matplot(t(stati_fda[-c(61,119) ,-1]), type='l')
matplot(t(stati_fda[-61 ,-1]), type='l')
matplot(t(stati_fda[-61 ,-1]), type='l')
matplot(t(stati_fda[-c(61,119) ,-1]), type='l')
[which(stati_new1$x==max(stati_new1$x))
which(stati_new1$x==max(stati_new1$x)
cdf
which(stati_new1$x==max(stati_new1$x))
stati_new[1255,]
stati_new1[1255,]
stati_new1[1282,]
stati_new1
1190+252
stati_new1=stati_new[-which(stati$Country=='Philippines'),]
stati_new1[which(stati_new1$x==max(stati_new1$x)),1]
stati_new
stati
1222-6
1216-26
stati_new1
stati_new1=stati_new[-which(stati$Country=='Philippines'),]
which(stati_new1$x==max(stati_new1$x))
stati_new1[1255,]
which(stati$Country=='Philippines')
stati_new[1282,]
stati_new1=stati_new[-c(which(stati$Country=='Philippines')),]
stati_new1[which(stati_new1$x==max(stati_new1$x)),1]
c(which(stati$Country=='Philippines'))
stati_new[209,]
stati_new[237,]
stati_new[1148,]
stati_new[1460,]
stati_new[324,]
stati_new[237,]
-which(stati$Country=='Philippines')
-c(which(stati$Country=='Philippines'))
#nuovo dataset senza Ghana
stati_new=stati[-which(stati$Country=='Ghana'),]
which(stati$Country=='Ghana')
stati[296,]
stati[416,]
stati[710,]
stati[1016,]
stati[1243,]
stati[1400,]
#nuovo dataset senza Ghana
stati_new=stati[-which(stati$Country=='Ghana'),]
stati_new[which(stati_new$x==max(stati_new$x)),1]
stati_new[which(stati$Country=='Ghana'),]
stati_new[which(stati_new$Country=='Ghana'),]
stati_new1=stati_new[-which(stati$Country=='Philippines'),]
stati_new1[which(stati_new1$Country=='Philippines'),]
stati_new1=stati_new[-which(stati$Country=='Philippines'),]
stati_new[which(stati_new$Country=='Ghana'),]
stati_new1[which(stati_new1$Country=='Philippines'),]
stati_new1=stati_new[-which(stati$Country=='Philippines'),]
